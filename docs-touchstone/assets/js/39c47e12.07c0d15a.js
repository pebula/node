"use strict";(self.webpackChunknode=self.webpackChunknode||[]).push([[4451],{6464:(e,n,t)=>{t.r(n),t.d(n,{contentTitle:()=>i,default:()=>l,frontMatter:()=>r,toc:()=>a});var o=t(4848),s=t(8453),c=t(6640);const r={id:"documents-and-sub-documents",title:"Documents And SubDocuments",sidebar_label:"3. Documents & SubDocuments"},i=void 0,a=[{value:"Document Options (metadata)",id:"document-options-metadata",level:2},{value:"GtSubDocumentMetadataArgs.noId",id:"gtsubdocumentmetadataargsnoid",level:4},{value:"GtDocumentMetadataArgs.connectionId",id:"gtdocumentmetadataargsconnectionid",level:4}];function d(e){const n={admonition:"admonition",code:"code",h2:"h2",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"GooseType"})," provide support for mongoose's ",(0,o.jsx)(c.pX,{type:"document",children:"Document"})," & ",(0,o.jsx)(c.pX,{type:"subDocument",children:"Sub Document"})]}),"\n",(0,o.jsx)("div",{class:"container",children:(0,o.jsxs)("div",{class:"row",children:[(0,o.jsxs)("div",{class:"col col-6",children:[(0,o.jsxs)(n.p,{children:["A ",(0,o.jsx)("strong",{children:"Document"})," is a class:"]}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Decorated with @GtDocument"}),(0,o.jsx)("li",{children:"Extends GtModel()"})]})]}),(0,o.jsxs)("div",{class:"col col-6",children:[(0,o.jsxs)(n.p,{children:["A ",(0,o.jsx)("strong",{children:"Subdocument"})," is a class:"]}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Decorated with @GtSubDocument"}),(0,o.jsx)("li",{children:"Extends GtResource()"})]})]})]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { GtSubDocument, GtResource, GtDocument, GtModel, GtColumn } from '@pebula/goosetyped';\n\n@GtSubDocument({ noId: true })\nexport class Address extends GtResource() {\n  @GtColumn()\n  street: string;\n\n  @GtColumn()\n  country: string;\n}\n\n@GtDocument()\nexport class Customer extends GtModel() {\n  @GtColumn()\n  name: string;\n\n  @GtColumn()\n  age: number;\n\n  @GtColumn()\n  address: Address;\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"document-options-metadata",children:"Document Options (metadata)"}),"\n",(0,o.jsx)(n.p,{children:"Most of the metadata options are straight-forward and well documented in the Api Docs."}),"\n",(0,o.jsxs)(n.p,{children:["For depp inspection check ",(0,o.jsx)(c.ol,{type:"interface",symbol:"GtDocumentMetadataArgs"})," & ",(0,o.jsx)(c.ol,{type:"interface",symbol:"GtSubDocumentMetadataArgs"})]}),"\n",(0,o.jsx)(n.p,{children:"We will cover some of them here:"}),"\n",(0,o.jsx)(n.h4,{id:"gtsubdocumentmetadataargsnoid",children:"GtSubDocumentMetadataArgs.noId"}),"\n",(0,o.jsxs)(n.p,{children:["This will disable the automatic ",(0,o.jsx)(n.code,{children:"_id"})," set for every sub document. ",(0,o.jsx)(c.pX,{type:"schema",hash:"_id",children:"Read more here..."})]}),"\n",(0,o.jsx)(n.admonition,{type:"caution",children:(0,o.jsx)(n.p,{children:"Since Document model must have an id, this is only valid for SubDocuments"})}),"\n",(0,o.jsx)(n.h4,{id:"gtdocumentmetadataargsconnectionid",children:"GtDocumentMetadataArgs.connectionId"}),"\n",(0,o.jsx)(n.p,{children:"The connection id to use when creating the model."}),"\n",(0,o.jsxs)(n.p,{children:["When not set, ",(0,o.jsx)(n.strong,{children:"GooseTyped"})," will use the default connection.\nWhen set, ",(0,o.jsx)(n.strong,{children:"GooseTyped"})," will use the registered connection to compile the model at the defined stage in the connections life."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import mongoose from 'mongoose';\nimport { GtDocument, GtModel, GtColumn, addConnection } from '@pebula/goosetyped';\n\n@GtDocument({\n  connectionId: 'myConnection',\n})\nexport class Customer extends GtModel() {\n  @GtColumn()\n  name: string;\n\n  @GtColumn()\n  age: number;\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["At this point the model class is available, but it ",(0,o.jsx)(n.strong,{children:"is not connect"})," to mongoose so no point of creating new instances of it..."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"const connection = mongoose.createConnection('localhost',{ /* ...*/ });\nconst ready = addConnection('myConnection', () => connection);\nawait ready;\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Once ",(0,o.jsx)(n.code,{children:"ready"})," resolves we have a guarantee that all models are compiled and bound to the connection."]}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsxs)(n.p,{children:["Deffered model compilation is explained in more detail in the ",(0,o.jsx)(c.jd,{to:"docs/advanced/async-model-compilation",children:"Async Model Compilation"}),"."]})})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},6640:(e,n,t)=>{t.d(n,{ol:()=>a,z7:()=>h,jd:()=>p,pX:()=>g});var o=t(6540),s=t(6025),c=t(4586),r=t(8774),i=t(4848);function a(e){var n=(0,c.A)(),t=e.symbol;return(0,i.jsx)(r.A,{to:(0,s.A)(""+n.siteConfig.customFields.apiDocPrefix+t.toLowerCase()),children:e.children||t})}var d=t(5293),l=t(1765);const u={plain:{color:"#f8f8f2",backgroundColor:"#272822"},styles:[{types:["comment"],style:{color:"rgb(136, 132, 111)"}},{types:["string","changed"],style:{color:"rgb(230, 219, 116)"}},{types:["punctuation","tag","deleted"],style:{color:"rgb(249, 38, 114)"}},{types:["number","builtin"],style:{color:"rgb(174, 129, 255)"}},{types:["variable"],style:{color:"rgb(248, 248, 242)"}},{types:["function","attr-name","inserted"],style:{color:"rgb(166, 226, 46)"}}]},m={codeSnippet:"codeSnippet_KFiO"};function h(e){var n=(0,c.A)().siteConfig.themeConfig.prism||{},t=(0,o.useState)(!1),s=(t[0],t[1]);(0,o.useEffect)((function(){s(!0)}),[]);var r=(0,d.G)().isDarkTheme,a=n.theme||u,h=n.darkTheme||a,p=r?h:a,g=e.lang,x=void 0===g?"yaml":g,j=e.snippet;return(0,i.jsx)(l.f4,{theme:p,code:j,language:x,children:function(e){var n=e.className,t=e.style,o=e.tokens,s=e.getLineProps,c=e.getTokenProps;return(0,i.jsx)("pre",{className:n+" "+m.codeSnippet,style:t,children:o.map((function(e,n){return(0,i.jsx)("div",Object.assign({},s({line:e,key:n}),{children:e.map((function(e,n){return(0,i.jsx)("span",Object.assign({},c({token:e,key:n})))}))}))}))})}})}function p(e){var n=e.to;return(0,i.jsx)(r.A,{to:(0,s.A)(n),children:e.children})}function g(e){var n=(0,c.A)(),t=e.type,o=e.hash,s=e.display,r=n.siteConfig.customFields.mongooseDocsUrl+"/"+function(e){switch(e){case"schema":return"guide";case"schemaType":return"SchemaTypes";case"connection":return"Connections";case"model":return"Models";case"document":return"Documents";case"subDocument":return"subdocs";case"query":return"Queries";case"validation":return"Validation";case"middleware":return"Middleware";case"populate":return"Populate";case"discriminator":return"Discriminators";case"plugins":return"Plugins"}throw new Error("Unknown link segment type "+e)}(t).toLowerCase()+".html"+(o?"#"+o:"");return(0,i.jsx)("a",{href:r,target:"_blank",children:e.children||s||o||""})}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>i});var o=t(6540);const s={},c=o.createContext(s);function r(e){const n=o.useContext(c);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(c.Provider,{value:n},e.children)}}}]);