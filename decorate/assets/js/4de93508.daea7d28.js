(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{103:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(98),o=n(91),c=n(57),s=n.n(c);var l=37,p=39;t.a=function(e){var t=e.lazy,n=e.block,c=e.defaultValue,u=e.values,b=e.groupId,d=e.className,m=Object(i.a)(),h=m.tabGroupChoices,f=m.setTabGroupChoices,g=Object(a.useState)(c),v=g[0],O=g[1],j=a.Children.toArray(e.children),y=[];if(null!=b){var x=h[b];null!=x&&x!==v&&u.some((function(e){return e.value===x}))&&O(x)}var w=function(e){var t=e.target,n=y.indexOf(t),a=j[n].props.value;O(a),null!=b&&(f(b,a),setTimeout((function(){var e,n,a,r,i,o,c,l;(e=t.getBoundingClientRect(),n=e.top,a=e.left,r=e.bottom,i=e.right,o=window,c=o.innerHeight,l=o.innerWidth,n>=0&&i<=l&&r<=c&&a>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(s.a.tabItemActive),setTimeout((function(){return t.classList.remove(s.a.tabItemActive)}),2e3))}),150))},N=function(e){var t,n;switch(e.keyCode){case p:var a=y.indexOf(e.target)+1;n=y[a]||y[0];break;case l:var r=y.indexOf(e.target)-1;n=y[r]||y[y.length-1]}null===(t=n)||void 0===t||t.focus()};return r.a.createElement("div",{className:"tabs-container"},r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(o.a)("tabs",{"tabs--block":n},d)},u.map((function(e){var t=e.value,n=e.label;return r.a.createElement("li",{role:"tab",tabIndex:v===t?0:-1,"aria-selected":v===t,className:Object(o.a)("tabs__item",s.a.tabItem,{"tabs__item--active":v===t}),key:t,ref:function(e){return y.push(e)},onKeyDown:N,onFocus:w,onClick:w},n)}))),t?Object(a.cloneElement)(j.filter((function(e){return e.props.value===v}))[0],{className:"margin-vert--md"}):r.a.createElement("div",{className:"margin-vert--md"},j.map((function(e,t){return Object(a.cloneElement)(e,{key:t,hidden:e.props.value!==v})}))))}},104:function(e,t,n){"use strict";var a=n(0),r=n.n(a);t.a=function(e){var t=e.children,n=e.hidden,a=e.className;return r.a.createElement("div",{role:"tabpanel",hidden:n,className:a},t)}},88:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return p})),n.d(t,"default",(function(){return b}));var a=n(3),r=n(8),i=(n(0),n(92)),o=n(103),c=n(104);n(93);var s={id:"composing-decorator-api-class",title:"Decorator API Class Mixins",sidebar_label:"4. Decorator API Class Mixins"},l={unversionedId:"decorate-fluent/composing-decorator-api-class",id:"decorate-fluent/composing-decorator-api-class",isDocsHomePage:!1,title:"Decorator API Class Mixins",description:"In the previous page we create one big decorator API class with all of our plugins inside.",source:"@site/docs/decorate-fluent/composing-decorator-api-class.md",slug:"/decorate-fluent/composing-decorator-api-class",permalink:"/node/decorate/docs/decorate-fluent/composing-decorator-api-class",editUrl:"https://github.com/pebula/node/tree/master/apps/docs/decorate/docs/docs/decorate-fluent/composing-decorator-api-class.md",version:"current",sidebar_label:"4. Decorator API Class Mixins",sidebar:"someSidebar",previous:{title:"Decorator API Class",permalink:"/node/decorate/docs/decorate-fluent/decorator-api-class"},next:{title:"Real Life Example",permalink:"/node/decorate/docs/decorate-fluent/example"}},p=[{value:"Mixins",id:"mixins",children:[]},{value:"Decorator API Composition",id:"decorator-api-composition",children:[]}],u={toc:p};function b(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"In the previous page we create one big decorator API class with all of our plugins inside.",Object(i.b)("br",{parentName:"p"}),"\n","This is not extensible enough, we want to be able to populate our API with predefined plugins which we can share, install etc..."),Object(i.b)("p",null,"This is exactly what the library is designed for!"),Object(i.b)("h2",{id:"mixins"},"Mixins"),Object(i.b)("p",null,"A Mixin is small encapsulated logical container which implement a specific behavior which can be mixed into another class.  "),Object(i.b)("p",null,"With mixins we want to be able to write plugins in small, encapsulated and reuseable classes or better yet download them as a ",Object(i.b)("inlineCode",{parentName:"p"},"node_module")," package"),Object(i.b)("p",null,"We then import them and mix them onto our main ",Object(i.b)("strong",{parentName:"p"},"Fluent Decorator API")," class adding their behavior to our API."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Mixin 101")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"JavaScript does not allow multiple inheritance, a class may only extend from a single class.",Object(i.b)("br",{parentName:"p"}),"\n","To workaround this limitation we use Mixins."),Object(i.b)("p",{parentName:"div"},"Mixins are classes which are not extends but merged into a host class extending their functionality (methods, accessors) onto the host.\nSimply put, copying all of the property descriptors (static and prototype) onto the host class."),Object(i.b)("p",{parentName:"div"},Object(i.b)("strong",{parentName:"p"},"There is one constraint with Mixins"),", they are treated as abstract classes, never initialized nor their constructor invoked"),Object(i.b)("p",{parentName:"div"},"Read more about mixins in the ",Object(i.b)("a",{href:"https://www.typescriptlang.org/docs/handbook/mixins.html",target:"_blank"},"TypeScript Documentation for Mixins")))),Object(i.b)("p",null,"The library provides all of the tools to handle mixins, including handling of the combined type of all mixins, through the namespaces ",Object(i.b)("inlineCode",{parentName:"p"},"ApiMixin")," & ",Object(i.b)("inlineCode",{parentName:"p"},"SchemaMixin"),"."),Object(i.b)("h2",{id:"decorator-api-composition"},"Decorator API Composition"),Object(i.b)("p",null,"Going back to our property class decorator API ",Object(i.b)("inlineCode",{parentName:"p"},"MyPropertyDecoratorFluentApiClass"),", let's re-write it to use mixin plugins instead of coding\nthem in the body"),Object(i.b)(o.a,{defaultValue:"api",values:[{label:"Decorator API",value:"api"},{label:"./optional.ts",value:"optional"},{label:"./default.ts",value:"default"}],mdxType:"Tabs"},Object(i.b)(c.a,{value:"api",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-typescript"},"import { PropertyDecoratorArgs } from '@pebula/decorate';\nimport { SchemaMixin, ApiMixin } from '@pebula/decorate/fluent';\n\nimport { OptionalSchemaConfig, OptionalPluginApi } from './options';\nimport { DefaultSchemaConfig, DefaultPluginApi } from './default';\n\nexport class MyPropertyDecoratorSchemaConfig extends SchemaMixin.Property().With(OptionalSchemaConfig, DefaultSchemaConfig) { }\n\nexport class MyPropertyDecoratorFluentApiClass extends ApiMixin.Property<MyPropertyDecoratorSchemaConfig>().With(OptionalPluginApi, DefaultPluginApi) {\n  static schemaFactory(args: PropertyDecoratorArgs): MyPropertyDecoratorSchemaConfig {\n    return new MyPropertyDecoratorSchemaConfig(args.key as string);\n  }\n}\n"))),Object(i.b)(c.a,{value:"optional",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-typescript",metastring:'title="/optional.ts"',title:'"/optional.ts"'},"import { FluentMethodPlugin, FluentPropertyPlugin, ApiMixin } from '@pebula/decorate/fluent';\n\nexport class OptionalSchemaConfig {\n  optional?: boolean\n}\n\nexport abstract class OptionalPluginApi extends ApiMixin.MixinBase<OptionalSchemaConfig> {\n  @FluentPropertyPlugin()\n  get optional(): this {\n    this.$$context.schema.optional = true;\n    return this;\n  }\n}\n\n"))),Object(i.b)(c.a,{value:"default",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-typescript",metastring:'title="/default.ts"',title:'"/default.ts"'},"import { FluentMethodPlugin, FluentPropertyPlugin, ApiMixin } from '@pebula/decorate/fluent';\n\nexport class DefaultSchemaConfig {\n  defaultValue?: any;\n}\n\nexport abstract class DefaultPluginApi extends ApiMixin.MixinBase<DefaultSchemaConfig> {\n  @FluentMethodPlugin()\n  default(value: any): this {\n    this.$$context.schema.defaultValue = value;\n    return this;\n  }\n\n}\n")))),Object(i.b)("p",null,"Couple of points:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Plugins ",Object(i.b)("strong",{parentName:"p"},"do not")," extend the same class the main ",Object(i.b)("em",{parentName:"p"},"Fluent Decorator API")," class does (e.g. ",Object(i.b)("inlineCode",{parentName:"p"},"DecorPropertyApi"),").",Object(i.b)("br",{parentName:"p"}),"\n","Instead, they extend a designated mixin base class, ",Object(i.b)("inlineCode",{parentName:"p"},"ApiMixin.MixinBase"),", following the template type used as their schema configuration object.",Object(i.b)("br",{parentName:"p"}),"\n","Extending from ",Object(i.b)("inlineCode",{parentName:"p"},"MixinBase")," is mandatory, the framework will not accept mixins that does not originate from ",Object(i.b)("inlineCode",{parentName:"p"},"MixinBase"),".")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"The main ",Object(i.b)("em",{parentName:"p"},"Fluent Decorator API")," class and ",Object(i.b)("strong",{parentName:"p"},"Schema Configuration")," class now have a ",Object(i.b)("strong",{parentName:"p"},"different extend expression")))),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"We've forced one plugin for each ",Object(i.b)("inlineCode",{parentName:"p"},"optional")," and ",Object(i.b)("inlineCode",{parentName:"p"},"default"),".",Object(i.b)("br",{parentName:"p"}),"\n","In real life plugins usually group several members which share the same logical idea."))),Object(i.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"On this page we address the composition of a ",Object(i.b)("strong",{parentName:"p"},"Fluent Decorator API")," class through a base class mixin.",Object(i.b)("br",{parentName:"p"}),"\n","That is, we create a new base class and mix in all of our mixins into the new base class, we then declare a class which ",Object(i.b)("strong",{parentName:"p"},"extend")," the new mixed in base class."),Object(i.b)("p",{parentName:"div"},"This is the classic approach to mixins."),Object(i.b)("p",{parentName:"div"},"There is another mixin scenario where a ",Object(i.b)("strong",{parentName:"p"},"Fluent Decorator API")," class already exists and we want to extend it after the fact.",Object(i.b)("br",{parentName:"p"}),"\n","This is bit more advanced as it requires using typescript augmentation and a slightly different mixin behavior."),Object(i.b)("p",{parentName:"div"},"For example, a node module you've installed which uses the ",Object(i.b)("strong",{parentName:"p"},"Fluent")," library and you would like to extend it...."),Object(i.b)("p",{parentName:"div"},"We'll discuss this topic in a later phase"))))}b.isMDXComponent=!0},91:function(e,t,n){"use strict";function a(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}},92:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},u=function(e){var t=p(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=a,m=u["".concat(o,".").concat(d)]||u[d]||b[d]||i;return n?r.a.createElement(m,c(c({ref:t},l),{},{components:n})):r.a.createElement(m,c({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},93:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(16),r=n(97);function i(){var e=Object(a.default)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,a){var i=void 0===a?{}:a,o=i.forcePrependBaseUrl,c=void 0!==o&&o,s=i.absolute,l=void 0!==s&&s;if(!n)return n;if(n.startsWith("#"))return n;if(Object(r.b)(n))return n;if(c)return t+n;var p=n.startsWith(t)?n:t+n.replace(/^\//,"");return l?e+p:p}(i,n,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},97:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!a(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},98:function(e,t,n){"use strict";var a=n(0),r=n(99);t.a=function(){var e=Object(a.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},99:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)(void 0);t.a=r}}]);