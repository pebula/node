(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{275:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return b})),n.d(t,"metadata",(function(){return p})),n.d(t,"toc",(function(){return f})),n.d(t,"default",(function(){return v}));var o=n(3),r=n(8),c=n(0),a=n.n(c),s=n(277),i=n(278),u=n(280);n(119);var d=function(e){var t=e.to;return a.a.createElement(u.a,{to:Object(i.a)(t)},e.children)},l=n(285),m=n(284),b={id:"documents-and-sub-documents",title:"Documents And SubDocuments",sidebar_label:"3. Documents & SubDocuments"},p={unversionedId:"basics/documents-and-sub-documents",id:"basics/documents-and-sub-documents",isDocsHomePage:!1,title:"Documents And SubDocuments",description:"GooseType provide support for mongoose's Document & Sub Document",source:"@site/docs/basics/documents-and-sub-documents.md",slug:"/basics/documents-and-sub-documents",permalink:"/node/goosetyped/docs/basics/documents-and-sub-documents",editUrl:"https://github.com/pebula/node/tree/master/apps/dpcs/touchstone/docs/docs/basics/documents-and-sub-documents.md",version:"current",sidebar_label:"3. Documents & SubDocuments",sidebar:"someSidebar",previous:{title:"Columns",permalink:"/node/goosetyped/docs/basics/columns"},next:{title:"Mixins",permalink:"/node/goosetyped/docs/basics/mixins"}},f=[{value:"Document Options (metadata)",id:"document-options-metadata",children:[]}],O={toc:f};function v(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(o.a)({},O,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"GooseType")," provide support for mongoose's ",Object(s.b)(m.a,{type:"document",mdxType:"MongooseDocsLink"},"Document")," & ",Object(s.b)(m.a,{type:"subDocument",mdxType:"MongooseDocsLink"},"Sub Document")),Object(s.b)("div",{class:"container"},Object(s.b)("div",{class:"row"},Object(s.b)("div",{class:"col col-6"},"A ",Object(s.b)("strong",null,"Document")," is a class:",Object(s.b)("ul",null,Object(s.b)("li",null,"Decorated with @GtDocument"),Object(s.b)("li",null,"Extends GtModel()"))),Object(s.b)("div",{class:"col col-6"},"A ",Object(s.b)("strong",null,"Subdocument")," is a class:",Object(s.b)("ul",null,Object(s.b)("li",null,"Decorated with @GtSubDocument"),Object(s.b)("li",null,"Extends GtResource()"))))),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-ts"},"import { GtSubDocument, GtResource, GtDocument, GtModel, GtColumn } from '@pebula/goosetyped';\n\n@GtSubDocument({ noId: true })\nexport class Address extends GtResource() {\n  @GtColumn()\n  street: string;\n\n  @GtColumn()\n  country: string;\n}\n\n@GtDocument()\nexport class Customer extends GtModel() {\n  @GtColumn()\n  name: string;\n\n  @GtColumn()\n  age: number;\n\n  @GtColumn()\n  address: Address;\n}\n")),Object(s.b)("h2",{id:"document-options-metadata"},"Document Options (metadata)"),Object(s.b)("p",null,"Most of the metadata options are straight-forward and well documented in the Api Docs."),Object(s.b)("p",null,"For depp inspection check ",Object(s.b)(l.a,{type:"interface",symbol:"GtDocumentMetadataArgs",mdxType:"ApiDocsLink"})," & ",Object(s.b)(l.a,{type:"interface",symbol:"GtSubDocumentMetadataArgs",mdxType:"ApiDocsLink"})),Object(s.b)("p",null,"We will cover some of them here:"),Object(s.b)("h4",{id:"gtsubdocumentmetadataargsnoid"},"GtSubDocumentMetadataArgs.noId"),Object(s.b)("p",null,"This will disable the automatic ",Object(s.b)("inlineCode",{parentName:"p"},"_id")," set for every sub document. ",Object(s.b)(m.a,{type:"schema",hash:"_id",mdxType:"MongooseDocsLink"},"Read more here...")),Object(s.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(s.b)("div",{parentName:"div",className:"admonition-heading"},Object(s.b)("h5",{parentName:"div"},Object(s.b)("span",{parentName:"h5",className:"admonition-icon"},Object(s.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},Object(s.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),Object(s.b)("div",{parentName:"div",className:"admonition-content"},Object(s.b)("p",{parentName:"div"},"Since Document model must have an id, this is only valid for SubDocuments"))),Object(s.b)("h4",{id:"gtdocumentmetadataargsconnectionid"},"GtDocumentMetadataArgs.connectionId"),Object(s.b)("p",null,"The connection id to use when creating the model."),Object(s.b)("p",null,"When not set, ",Object(s.b)("strong",{parentName:"p"},"GooseTyped")," will use the default connection.\nWhen set, ",Object(s.b)("strong",{parentName:"p"},"GooseTyped")," will use the registered connection to compile the model at the defined stage in the connections life."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-ts"},"import mongoose from 'mongoose';\nimport { GtDocument, GtModel, GtColumn, addConnection } from '@pebula/goosetyped';\n\n@GtDocument({\n  connectionId: 'myConnection',\n})\nexport class Customer extends GtModel() {\n  @GtColumn()\n  name: string;\n\n  @GtColumn()\n  age: number;\n}\n")),Object(s.b)("p",null,"At this point the model class is available, but it ",Object(s.b)("strong",{parentName:"p"},"is not connect")," to mongoose so no point of creating new instances of it..."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-typescript"},"const connection = mongoose.createConnection('localhost',{ /* ...*/ });\nconst ready = addConnection('myConnection', () => connection);\nawait ready;\n")),Object(s.b)("p",null,"Once ",Object(s.b)("inlineCode",{parentName:"p"},"ready")," resolves we have a guarantee that all models are compiled and bound to the connection."),Object(s.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(s.b)("div",{parentName:"div",className:"admonition-heading"},Object(s.b)("h5",{parentName:"div"},Object(s.b)("span",{parentName:"h5",className:"admonition-icon"},Object(s.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(s.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(s.b)("div",{parentName:"div",className:"admonition-content"},Object(s.b)("p",{parentName:"div"},"Deffered model compilation is explained in more detail in the ",Object(s.b)(d,{to:"docs/advanced/async-model-compilation",mdxType:"DocLink"},"Async Model Compilation"),"."))))}v.isMDXComponent=!0},277:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return p}));var o=n(0),r=n.n(o);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},c=Object.keys(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=r.a.createContext({}),d=function(e){var t=r.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l=function(e){var t=d(e.components);return r.a.createElement(u.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,c=e.originalType,a=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),l=d(n),b=o,p=l["".concat(a,".").concat(b)]||l[b]||m[b]||c;return n?r.a.createElement(p,s(s({ref:t},u),{},{components:n})):r.a.createElement(p,s({ref:t},u))}));function p(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var c=n.length,a=new Array(c);a[0]=b;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var u=2;u<c;u++)a[u]=n[u];return r.a.createElement.apply(null,a)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},278:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a}));var o=n(16),r=n(281);function c(){var e=Object(o.default)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,c=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,o){var c=void 0===o?{}:o,a=c.forcePrependBaseUrl,s=void 0!==a&&a,i=c.absolute,u=void 0!==i&&i;if(!n)return n;if(n.startsWith("#"))return n;if(Object(r.b)(n))return n;if(s)return t+n;var d=n.startsWith(t)?n:t+n.replace(/^\//,"");return u?e+d:d}(c,n,e,t)}}}function a(e,t){return void 0===t&&(t={}),(0,c().withBaseUrl)(e,t)}},280:function(e,t,n){"use strict";var o=n(0),r=n.n(o),c=n(10),a=n(281),s=n(7),i=Object(o.createContext)({collectLink:function(){}}),u=n(278),d=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};t.a=function(e){var t,n,l,m=e.isNavLink,b=e.to,p=e.href,f=e.activeClassName,O=e.isActive,v=e["data-noBrokenLinkCheck"],h=e.autoAddBaseUrl,g=void 0===h||h,j=d(e,["isNavLink","to","href","activeClassName","isActive","data-noBrokenLinkCheck","autoAddBaseUrl"]),y=Object(u.b)().withBaseUrl,w=Object(o.useContext)(i),D=b||p,N=Object(a.a)(D),C=null==D?void 0:D.replace("pathname://",""),x=void 0!==C?(n=C,g&&function(e){return e.startsWith("/")}(n)?y(n):n):void 0,G=Object(o.useRef)(!1),k=m?c.e:c.c,M=s.a.canUseIntersectionObserver;Object(o.useEffect)((function(){return!M&&N&&window.docusaurus.prefetch(x),function(){M&&l&&l.disconnect()}}),[x,M,N]);var E=null!==(t=null==x?void 0:x.startsWith("#"))&&void 0!==t&&t,S=!x||!N||E;return x&&N&&!E&&!v&&w.collectLink(x),S?r.a.createElement("a",Object.assign({href:x},D&&!N&&{target:"_blank",rel:"noopener noreferrer"},j)):r.a.createElement(k,Object.assign({},j,{onMouseEnter:function(){G.current||(window.docusaurus.preload(x),G.current=!0)},innerRef:function(e){var t,n;M&&e&&N&&(t=e,n=function(){window.docusaurus.prefetch(x)},(l=new window.IntersectionObserver((function(e){e.forEach((function(e){t===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(l.unobserve(t),l.disconnect(),n())}))}))).observe(t))},to:x||""},m&&{isActive:O,activeClassName:f}))}},281:function(e,t,n){"use strict";function o(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!o(e)}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}))},284:function(e,t,n){"use strict";var o=n(0),r=n.n(o),c=(n(57),n(16));t.a=function(e){var t=Object(c.default)(),n=e.type,o=e.hash,a=e.display,s=t.siteConfig.customFields.mongooseDocsUrl+"/"+function(e){switch(e){case"schema":return"guide";case"schemaType":return"SchemaTypes";case"connection":return"Connections";case"model":return"Models";case"document":return"Documents";case"subDocument":return"subdocs";case"query":return"Queries";case"validation":return"Validation";case"middleware":return"Middleware";case"populate":return"Populate";case"discriminator":return"Discriminators";case"plugins":return"Plugins"}throw new Error("Unknown link segment type "+e)}(n).toLowerCase()+".html"+(o?"#"+o:"");return r.a.createElement("a",{href:s,target:"_blank"},e.children||a||o||"")}},285:function(e,t,n){"use strict";var o=n(0),r=n.n(o),c=n(278),a=n(16),s=n(280);n(58);t.a=function(e){var t=Object(a.default)(),n=e.symbol;return r.a.createElement(s.a,{to:Object(c.a)(""+t.siteConfig.customFields.apiDocPrefix+n.toLowerCase())},e.children||n)}}}]);